# Specification

## 基本情報

- **Editor**: Ryohei Yamada
- **更新日**: 2025/08/30

## コンセプト

- Markdown初心者〜ビジネスユーザー向け
- エンジニアも文書作成用途で効率的に使用可能
- Notion風ビューをデフォルト、オプションで WYSIWYM風ビュー に切替可能
- 図や表には説明文（キャプション）を付与可能。キャプションは図は下、表は上に表示。

## UI構成

### 上部ツールバー

- **ファイル / 編集 / 挿入 / フォーマット / 表示**
- **画像挿入ボタン追加**: ドラッグ＆ドロップやコピー＆ペーストでも可能。挿入時にキャプション行が自動生成される。

### 表示タブ

- **デフォルト**: Notion風（リッチビュー編集型）
- **オプション**: WYSIWYM風（Markdown記号を残した軽量ビュー）

### サイドバー

- **アウトライン表示**
- **相互リンクパネル**（折り畳み可能）

### 表機能

- **ツールバーから挿入** → 行列数指定
- **セル右クリックで編集メニュー**（行/列追加・削除、セル結合/分割）
- **GUI操作** → Markdown表形式に自動整形
- **表挿入時**は自動で「キャプション行」を上に生成。ユーザー未入力なら非表示。

### 画像挿入

- **対応方法**: ドラッグ＆ドロップ + コピー＆ペースト + ツールバー挿入ボタン
- **挿入時に自動でキャプション行生成**（下に配置）
- **未入力の場合は表示なし**
- **内部保存**: `/images/` に格納、Markdownで参照
- **PDF出力**: 画像は埋め込み

## 保存形式

- **通常保存**: `.mdxdoc`（内部はアーカイブ）
  - `content.md`（本文）
  - `/images/`（画像）
  - `meta.json`（リンク情報など、図・表とキャプションをセットで管理）
- **エクスポート**:
  - Markdown（`.md`）
    - 図: `![](image.png)`\n図: 説明文
    - 表: 表: 説明文\n`| ... | ... |`
  - PDF（ビジネス文書 or 技術文書スタイル切替可）
  - AI用ファイル（`.mdpack`：Markdown + 画像 + メタ情報まとめ）

## PDFデザイン

- **デフォルト**: ビジネス文書向け
  - 白背景、明朝/ゴシック体、見出し階層強調、A4余白
  - 図: 下にキャプション、表: 上にキャプション
- **切替可能**: 技術文書向け
  - 等幅フォント、コードハイライト、LaTeX数式、余白狭め

## ショートカット（見た目関連）

- `Ctrl + B` → 太字
- `Ctrl + I` → 斜体
- `Ctrl + U` → アンダーライン
- `Ctrl + Shift + S` → 取り消し線
- `Ctrl + 1〜6` → 見出しレベル
- `Ctrl + Shift + L` → 箇条書き
- `Ctrl + Shift + N` → 番号付きリスト

## 補完機能（標準搭載）

- **レベル2**: スマート補完
  - 記号の自動補完（`**` → `|`, \`\`\` → 自動閉じ）
  - 数式 `$` → `$|$`
  - リストの自動継続（`-` / `1.`）
  - **用途**: 記法を意識せず、効率的に執筆可能

## 相互リンクUI

- **サイドバーに「リンクパネル」配置**
  - 折り畳み可能で非表示もOK
  - 関連文書一覧・検索・ジャンプ対応
- **本文右クリック → [リンク挿入]** で Markdownリンク生成

## キャプション管理（新機能）

- **図・表とキャプションを 内部データ構造でセット管理**
  ```json
  {
    "type": "figure",
    "kind": "image" | "table",
    "src": "example.png" | null,
    "table_data": [...],
    "caption": "説明文テキスト"
  }
  ```
- **挿入時に自動でキャプション行生成**
- **未入力時はビューで非表示**
- **Markdown / HTML / PDF出力時も図・表との関連を維持**
- **将来的にキャプション番号自動付与対応予定**